<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>jQuery test</title>
    <script src="./jquery-3.2.1.js"></script>
    <style media="screen">
      .number-area {
        border: solid 1px black;
        width: 270px;
      }

      [type=text] {
        height: 28px;
        width: 28px;
        border: 1px solid black;
        text-align: center;
      }

    </style>
  </head>
  <body>
    <div class="number-area"></div>

    <script type="text/javascript">


      Array.prototype.remove = function (number){
        if (typeof(number) == 'object' && number.constructor.toString().includes('Array')) {
          number.forEach(x => kernel.remove(x));
        }

        if (typeof(number) == 'string'){
          if (this.indexOf(number) == -1) {
            return this.slice();
          }
          else {
            return this.splice(this.indexOf(number), 1);
          }
        }
      }

      function kernelArray() {
        return ['1', '2', '3', '4', '5', '6', '7', '8', '9'];
      }

      function k(i, j) {
        return parseInt(i/3)*3 + parseInt(j/3);
      }

      function toArray($obj) {
        let a = [];
        $obj.each(function(){
          a.push($(this).val());
        });
        return a.slice();
      }

      for(let i = 0; i < 9; ++i) {
        for(let j = 0; j < 9; ++j) {
          const number_box = document.createElement('input');
          const $nbox = $(number_box);
          $nbox.attr('data-i', i);
          $nbox.attr('data-j', j);
          $nbox.attr('data-k', k(i, j));
          // console.log(i, j, i%3, parseInt(i/3), j%3, parseInt(j/3));
          // console.log(parseInt(i/3)*3 + parseInt(j/3));
          $nbox.attr('type', 'text');
          $nbox.attr('value', '0');
          $('.number-area').append($nbox);
        }
      }

      function remove(i, j) {
        value = $(`[data-i="${i}"][data-j="${j}"][data-k="${k(i, j)}"]`).val();
        if (value != 0) return;
        curr = toArray($(`[data-i=${i}]`));
        kernel.remove(curr);
        curr = toArray($(`[data-j=${j}]`));
        kernel.remove(curr);
        curr = toArray($(`[data-k=${k(i, j)}]`));
        kernel.remove(curr);

        console.log(i, j, kernel);

        if (kernel.length == 1) {
          setValue(i, j, kernel[0]);
          // $(`[data-i="${i}"][data-j="${j}"][data-k="${k(i, j)}"]`).val();
        }
      }

      function Go(){
        for(let i = 0; i < 9; ++i) {
          for(let j = 0; j < 9; ++j) {
            kernel = kernelArray();
            remove(i, j);
          }
        }
      }





      function setValue(n1, n2, value) {
        $(`[data-i="${n1}"][data-j="${n2}"][data-k="${k(n1, n2)}"]`).css('background-color', '#c8c8c8').val(value);
      }

      setValue(0, 1, 6);
      setValue(0, 2, 8);
      setValue(0, 6, 9);
      setValue(0, 7, 2);
      setValue(1, 4, 1);
      setValue(2, 0, 1);
      setValue(2, 1, 3);
      setValue(2, 4, 8);
      setValue(2, 4, 8);
      setValue(2, 7, 6);
      setValue(2, 8, 5);
      // ------------
      setValue(3, 0, 2);
      setValue(3, 8, 6);
      setValue(5, 0, 5);
      setValue(5, 1, 9);
      setValue(5, 7, 7);
      setValue(5, 8, 3);
      // ------------
      setValue(6, 2, 1);
      setValue(6, 3, 4);
      setValue(6, 5, 9);
      setValue(6, 6, 2);
      setValue(7, 2, 9);
      setValue(7, 4, 2);
      setValue(7, 6, 5);

      setValue(8, 1, 8);
      setValue(8, 3, 8);
      setValue(8, 5, 1);
      setValue(8, 7, 3);

    </script>
  </body>
</html>
